const _0x24e6=['delete','length','limit','orderBy','Image','getImages','./RepositoryBase','exerciseId','count(*)','exports','max','whereIn','number','updateImage','handleConstraintError','handleError','insert','imageNumber','isArray','getImageById','getFirstImageByAttrs','update','where','insertImage','offset'];(function(_0x2c7fed,_0x24e66a){const _0x1a8a6c=function(_0x1aa737){while(--_0x1aa737){_0x2c7fed['push'](_0x2c7fed['shift']());}};_0x1a8a6c(++_0x24e66a);}(_0x24e6,0x167));const _0x1a8a=function(_0x2c7fed,_0x24e66a){_0x2c7fed=_0x2c7fed-0x0;let _0x1a8a6c=_0x24e6[_0x2c7fed];return _0x1a8a6c;};const _0x379635=_0x1a8a,RepositoryBase=require(_0x379635('0x16'));module[_0x379635('0x0')]=class ImageRepository extends RepositoryBase{constructor(_0x1aa737){super(),this['db']=_0x1aa737;}async[_0x379635('0xa')](_0x56520a){return this['getFirstImageByAttrs']({'id':_0x56520a});}async['getImageByIds'](_0x23da4f,_0x44f65d){const _0x44bba9=_0x379635;return this[_0x44bba9('0xb')]({'exerciseId':_0x23da4f,'id':_0x44f65d});}async[_0x379635('0xb')](_0xe80af0){const _0x2ae660=_0x379635;try{const _0x3dec05=await this[_0x2ae660('0x15')](_0xe80af0,0x0,0x1),_0x1f840b=_0x3dec05['results'];if(!Array[_0x2ae660('0x9')](_0x1f840b)||_0x1f840b[_0x2ae660('0x11')]===0x0)return undefined;return _0x1f840b[0x0];}catch(_0x38803a){throw _0x38803a;}}async[_0x379635('0x15')](_0x1696b8,_0x1b517c,_0x23f64d,_0x5f1972=_0x379635('0x3'),_0x3ab801){const _0x2f8c8b=_0x379635;try{let _0x382a6a,_0x105ba4;if(Array['isArray'](_0x1696b8['id'])){const _0x20997d=_0x1696b8['id'];delete _0x1696b8['id'],_0x382a6a=await this['db'](_0x2f8c8b('0x14'))['whereIn']('id',_0x20997d)[_0x2f8c8b('0xd')](_0x1696b8)[_0x2f8c8b('0xf')](_0x1b517c)[_0x2f8c8b('0x12')](_0x23f64d)[_0x2f8c8b('0x13')](_0x5f1972,_0x3ab801),_0x105ba4=await this['db']('Image')[_0x2f8c8b('0x2')]('id',_0x20997d)[_0x2f8c8b('0xd')](_0x1696b8)['count']();}else _0x382a6a=await this['db'](_0x2f8c8b('0x14'))[_0x2f8c8b('0xd')](_0x1696b8)[_0x2f8c8b('0xf')](_0x1b517c)['limit'](_0x23f64d)['orderBy'](_0x5f1972,_0x3ab801),_0x105ba4=await this['db'](_0x2f8c8b('0x14'))[_0x2f8c8b('0xd')](_0x1696b8)['count']();for(let _0x429e67=0x0;_0x429e67<_0x382a6a[_0x2f8c8b('0x11')];_0x429e67++){delete _0x382a6a[_0x429e67][_0x2f8c8b('0x17')];}return{'totalCount':_0x105ba4[0x0][_0x2f8c8b('0x18')],'offset':_0x1b517c,'limit':_0x23f64d,'orderBy':_0x5f1972,'direction':_0x3ab801,'results':_0x382a6a};}catch(_0x1e4940){throw super[_0x2f8c8b('0x6')](_0x1e4940);}}async[_0x379635('0xe')](_0x403e15,_0x47ecaf){const _0x1ac494=_0x379635;try{let {number:_0x207a6b,url:_0x106c0b}=_0x47ecaf;if(!_0x207a6b&&_0x207a6b!==0x0){let _0x44a23d=await this['db'](_0x1ac494('0x14'))[_0x1ac494('0x1')]({'max':_0x1ac494('0x8')})[_0x1ac494('0xd')]({'exerciseId':_0x403e15});!Array[_0x1ac494('0x9')](_0x44a23d)||_0x44a23d[_0x1ac494('0x11')]===0x0?_0x207a6b=0x0:_0x207a6b=_0x44a23d[0x0][_0x1ac494('0x1')]+0x1;}const _0x6dcf9b=await this['db'](_0x1ac494('0x14'))[_0x1ac494('0x7')]({'exerciseId':_0x403e15,'number':_0x207a6b,'url':_0x106c0b});if(!_0x6dcf9b)return undefined;return await this[_0x1ac494('0xa')](_0x6dcf9b);}catch(_0x260ae5){throw super[_0x1ac494('0x5')](_0x260ae5);}}async[_0x379635('0x4')](_0x5d77e7,_0x552271){const _0x30d976=_0x379635;try{const {number:_0x3e011f,url:_0x56a92f}=_0x552271,_0x2a2e0b=await this['db']('Image')[_0x30d976('0xd')]({'id':_0x5d77e7})[_0x30d976('0xc')]({'number':_0x3e011f,'url':_0x56a92f});if(_0x2a2e0b===0x0)return undefined;return await this[_0x30d976('0xa')](_0x5d77e7);}catch(_0x24f69a){throw super[_0x30d976('0x5')](_0x24f69a);}}async['deleteImage'](_0x1ad9b6){const _0x7feb7e=_0x379635;try{return await this['db'](_0x7feb7e('0x14'))[_0x7feb7e('0xd')]({'id':_0x1ad9b6})[_0x7feb7e('0x10')]();}catch(_0x59e6d8){throw super[_0x7feb7e('0x6')](_0x59e6d8);}}};